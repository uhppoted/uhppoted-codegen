package functions

import (
	"github.com/uhppoted/uhppoted-codegen/model/requests"
	"github.com/uhppoted/uhppoted-codegen/model/responses"
)

var GetCardAtIndex = Function{
	Name: "get card at index",
	Description: []string{
		"Retrieves the card record stored at a given index.",
	},
	Args: []Arg{
		{
			Name:        "controller",
			Type:        "controller",
			Description: "uint32|Controller controller serial number or {id, address, protocol} Controller struct",
		},
		{
			Name:        "index",
			Type:        "uint32",
			Description: "card record index",
		},
	},
	Request:   requests.GetCardAtIndexRequest.Message,
	Response:  responses.GetCardAtIndexResponse.Message,
	Protocols: []string{"broadcast", "udp", "tcp"},

	Tests: []FuncTest{
		{
			Name: "get-card-at-index",
			Args: []TestArg{
				{
					Arg: Arg{
						Name: "controller",
						Type: "uint32",
					},
					Value: 405419896,
				},
				{
					Arg: Arg{
						Name: "index",
						Type: "uint32",
					},
					Value: 135,
				},
			},
			Request: []byte{
				0x17, 0x5c, 0x00, 0x00, 0x78, 0x37, 0x2a, 0x18, 0x87, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			},
			Replies: []TestReply{
				{
					Message: []byte{
						0x17, 0x5c, 0x00, 0x00, 0x78, 0x37, 0x2a, 0x18, 0xa0, 0x7a, 0x99, 0x00, 0x20, 0x25, 0x01, 0x01,
						0x20, 0x25, 0x12, 0x31, 0x01, 0x00, 0x11, 0x01, 0x6b, 0x1d, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
						0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
						0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
					},
					Response: []Value{
						{
							Name:  "controller",
							Type:  "uint32",
							Value: 405419896,
						},
						{
							Name:  "card",
							Type:  "uint32",
							Value: 10058400,
						},
						{
							Name:  "start-date",
							Type:  "optional date",
							Value: "2025-01-01",
						},
						{
							Name:  "end-date",
							Type:  "optional date",
							Value: "2025-12-31",
						},
						{
							Name:  "door 1",
							Type:  "uint8",
							Value: 1,
						},
						{
							Name:  "door 2",
							Type:  "uint8",
							Value: 0,
						},
						{
							Name:  "door 3",
							Type:  "uint8",
							Value: 17,
						},
						{
							Name:  "door 4",
							Type:  "uint8",
							Value: 1,
						},
						{
							Name:  "PIN",
							Type:  "pin",
							Value: 7531,
						},
					},
				},
			},
		},
		{
			Name: "get-card-at-index-not-found",
			Args: []TestArg{
				{
					Arg: Arg{
						Name: "controller",
						Type: "uint32",
					},
					Value: 405419896,
				},
				{
					Arg: Arg{
						Name: "index",
						Type: "uint32",
					},
					Value: 136,
				},
			},
			Request: []byte{
				0x17, 0x5c, 0x00, 0x00, 0x78, 0x37, 0x2a, 0x18, 0x88, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			},
			Replies: []TestReply{
				{
					Message: []byte{
						0x17, 0x5c, 0x00, 0x00, 0x78, 0x37, 0x2a, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
						0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
						0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
						0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
					},
					Response: []Value{
						{
							Name:  "controller",
							Type:  "uint32",
							Value: 405419896,
						},
						{
							Name:  "card",
							Type:  "uint32",
							Value: 0,
						},
						{
							Name:  "start-date",
							Type:  "optional date",
							Value: "0001-01-01",
						},
						{
							Name:  "end-date",
							Type:  "optional date",
							Value: "0001-01-01",
						},
						{
							Name:  "door 1",
							Type:  "uint8",
							Value: 0,
						},
						{
							Name:  "door 2",
							Type:  "uint8",
							Value: 0,
						},
						{
							Name:  "door 3",
							Type:  "uint8",
							Value: 0,
						},
						{
							Name:  "door 4",
							Type:  "uint8",
							Value: 0,
						},
						{
							Name:  "PIN",
							Type:  "pin",
							Value: 0,
						},
					},
				},
			},
		},
		{
			Name: "get-card-at-index-deleted",
			Args: []TestArg{
				{
					Arg: Arg{
						Name: "controller",
						Type: "uint32",
					},
					Value: 405419896,
				},
				{
					Arg: Arg{
						Name: "index",
						Type: "uint32",
					},
					Value: 137,
				},
			},
			Request: []byte{
				0x17, 0x5c, 0x00, 0x00, 0x78, 0x37, 0x2a, 0x18, 0x89, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
				0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
			},
			Replies: []TestReply{
				{
					Message: []byte{
						0x17, 0x5c, 0x00, 0x00, 0x78, 0x37, 0x2a, 0x18, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
						0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
						0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
						0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
					},
					Response: []Value{
						{
							Name:  "controller",
							Type:  "uint32",
							Value: 405419896,
						},
						{
							Name:  "card",
							Type:  "uint32",
							Value: uint32(0xffffffff),
						},
						{
							Name:  "start-date",
							Type:  "optional date",
							Value: "0001-01-01",
						},
						{
							Name:  "end-date",
							Type:  "optional date",
							Value: "0001-01-01",
						},
						{
							Name:  "door 1",
							Type:  "uint8",
							Value: 0,
						},
						{
							Name:  "door 2",
							Type:  "uint8",
							Value: 0,
						},
						{
							Name:  "door 3",
							Type:  "uint8",
							Value: 0,
						},
						{
							Name:  "door 4",
							Type:  "uint8",
							Value: 0,
						},
						{
							Name:  "PIN",
							Type:  "pin",
							Value: 0,
						},
					},
				},
			},
		},
	},
}
